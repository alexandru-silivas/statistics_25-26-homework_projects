// ------------------------------
// PASCAL TRIANGLE
// ------------------------------

function generatePascal(n) {
  const triangle = [];
  for (let i = 0; i < n; i++) {
    const row = [1];
    for (let j = 1; j < i; j++) {
      row[j] = triangle[i-1][j-1] + triangle[i-1][j];
    }
    if (i > 0) row.push(1);
    triangle.push(row);
  }
  return triangle;
}

function renderPascal() {
  const rows = parseInt(document.getElementById("pascalRows").value);
  const container = document.getElementById("pascalContainer");

  const triangle = generatePascal(rows);

  container.innerHTML = "";
  triangle.forEach(row => {
    const div = document.createElement("div");
    div.className = "pascal-row";
    div.textContent = row.join("   ");
    container.appendChild(div);
  });
}

window.addEventListener("DOMContentLoaded", renderPascal);


// ------------------------------
// RANDOM WALK CHART CREATOR
// ------------------------------

function bernoulliStep(p) {
  return Math.random() < p ? 1 : -1;
}

function randomWalk(steps, p) {
  let pos = 0;
  const arr = [0];
  for (let i = 0; i < steps; i++) {
    pos += bernoulliStep(p);
    arr.push(pos);
  }
  return arr;
}

function createWalkChart(id, data, labelText) {
  const ctx = document.getElementById(id).getContext("2d");
  return new Chart(ctx, {
    type: "line",
    data: {
      labels: Array.from({ length: data.length }, (_, i) => i),
      datasets: [{
        data,
        label: labelText,
        borderWidth: 2,
        fill: false
      }]
    },
    options: {
      scales: {
        x: { title: { display: true, text: "Step" } },
        y: { title: { display: true, text: "Position" } }
      }
    }
  });
}

window.addEventListener("DOMContentLoaded", () => {
  createWalkChart("rw1", randomWalk(50, 0.5), "Random Walk (p=0.5)");
  createWalkChart("rw2", randomWalk(50, 0.7), "Random Walk (p=0.7)");
});


// ------------------------------
// INTERACTIVE RANDOM WALK
// ------------------------------

let interactiveChart = null;

function simulateInteractiveWalk() {
  const p = parseFloat(document.getElementById("pInput").value);
  const steps = parseInt(document.getElementById("stepsInput").value);

  const data = randomWalk(steps, p);
  const ctx = document.getElementById("interactiveRandomWalk").getContext("2d");

  if (interactiveChart) interactiveChart.destroy();

  interactiveChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: Array.from({ length: data.length }, (_, i) => i),
      datasets: [{
        label: `Interactive Walk (p=${p})`,
        data,
        borderWidth: 2,
        fill: false
      }]
    },
    options: {
      scales: {
        x: { title: { display: true, text: "Step" } },
        y: { title: { display: true, text: "Position" } }
      }
    }
  });
}

function resetInteractiveWalk() {
  if (interactiveChart) interactiveChart.destroy();
}
